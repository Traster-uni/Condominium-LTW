ut_no_reg (cookie, ut_id)
ut_registrato(ut_id, nome, congome, usrname, passwd, dIscrizione, codice_fiscale)
Documenti(ut_id, img_ID, img_FisclCode)

Condomino (ut_id, pdf_doc_purchaseRent)
Amministratore(ut_id, pdf_doc_idAdmin)

Condominio(aptBlock_id, address, citta, )

req_ut_access(utReq_id, ut_id, aptBlock_id, time_born, time_mod, status:enum{accepted, refused, aborted})

req_aptBlock_create(utReq_id, utAdm_id, time_born, time_mod, status: enum{accept, refused})

aptBlock_form(utReq_id, address, citta, regione, img_docs)


[bb](0,N) <---> (0,N) [post] (0,N) <---> (0,1) [thread] (1,N) <---> (1,1) [reply]

Per far sı̀ che PHP possa utilizzare il DBMS PostgreSQL bisogna
utilizzare l’estensione pgsql:
Linux: Lanciare, tramite shell, il seguente comando: 
sudo apt install php-pgsql
Nel file di configurazione php.ini, decommentare la riga
“; extension=pgsql” (togliendo il “;” iniziale).
Per chi usa XAMPP: solitamente il file php.ini è situato nella
cartella C:\xampp\php

per ogni req_aptBlock_create va da 'pending' a 'accepted':
    crea una nuova istanza di aptBlock con 
    aptBlock_id = req_aptBlock_create(aptBlockReq_id)


per ogni nuovo aptBlock inserito 
    crea due nuove istanze di aptBlock_bulletinBoard con 
    aptBlock_bulletinBoard(aptBlock_id) = aptBlock(aptBlock_id)
    aptBlock_bulletinBoard(bb_name) = 'admin' and 'general'
    aptBlock_bulletinBoard(bb_year) = date_part(current_date, 'year')


 CREATE TABLE IF NOT EXISTS rental_request(
	rental_req_id serial,
	ut_id integer,
	adm_id integer,
	rental_time time NOT NULL, drop
	rental_day date CHECK (rental_day > current_date) NOT NULL, 
	retal_period integer CHECK (retal_period > 0),
	submit_time timestamp NOT NULL,
	stat request_status NOT NULL,
	PRIMARY KEY (rental_req_id),
	FOREIGN KEY (ut_id) REFERENCES ut_owner(utReq_id),
	FOREIGN KEY (adm_id) REFERENCES aptBlock_admin(ut_id)
 );

  CREATE TABLE IF NOT EXISTS rental_request(
	rental_req_id serial,
	ut_id integer,
	adm_id integer,
	rental_datatime_start timestamp NOT NULL, 
	rental_datatime_end timestamp NOT NULL CHECK(rental_datatime_end >= rental_datatime_start),
	submit_time timestamp NOT NULL,
	stat request_status NOT NULL,
	PRIMARY KEY (rental_req_id),
	FOREIGN KEY (ut_id) REFERENCES ut_owner(utReq_id),
	FOREIGN KEY (adm_id) REFERENCES aptBlock_admin(ut_id)
 );

ALTER TABLE ut_owner
    RENAME COLUMN ut_doc_fname TO ut_ownership_doc_fname,
    DROP COLUMN codice_fiscale;


$_FILES
Array ( [upload-img] => 
			Array ( [name] => FB_IMG_1533802567848.jpg 
					[full_path] => FB_IMG_1533802567848.jpg 
					[type] => image/jpeg [tmp_name] => C:\Users\trast\AppData\Local\Temp\php7569.tmp 
					[error] => 0 
					[size] => 30545 ) 
		)

$_FILES empty
Array ( [upload-img] => Array ( 
						[name] => 
						[full_path] => 
						[type] => 
						[tmp_name] => 
						[error] => 4 
						[size] => 0 ) ) 

$_SERVER
Array ( [DOCUMENT_ROOT] => C:\LTW-Condominium 
		[REMOTE_ADDR] => ::1 
		[REMOTE_PORT] => 65019 
		[SERVER_SOFTWARE] => PHP/8.3.6 (Development Server) 
		[SERVER_PROTOCOL] => HTTP/1.1 
		[SERVER_NAME] => localhost 
		[SERVER_PORT] => 3000 
		[REQUEST_URI] => /Condominiunm-LTW/global/04-php/upload.php 
		[REQUEST_METHOD] => POST 
		[SCRIPT_NAME] => /Condominiunm-LTW/global/04-php/upload.php 
		[SCRIPT_FILENAME] => C:\LTW-Condominium\Condominiunm-LTW\global\04-php\upload.php 
		[PHP_SELF] => /Condominiunm-LTW/global/04-php/upload.php 
		[HTTP_HOST] => localhost:3000 
		[HTTP_CONNECTION] => keep-alive 
		[CONTENT_LENGTH] => 291 
		[HTTP_CONTENT_LENGTH] => 291 
		[HTTP_CACHE_CONTROL] => max-age=0 
		[HTTP_SEC_CH_UA] => "Chromium";v="124", "Google Chrome";v="124", "Not-A.Brand";v="99" 
		[HTTP_SEC_CH_UA_MOBILE] => ?0 
		[HTTP_SEC_CH_UA_PLATFORM] => "Windows" 
		[HTTP_ORIGIN] => http://localhost:3000 
		[HTTP_DNT] => 1 
		[HTTP_UPGRADE_INSECURE_REQUESTS] => 1 
		[CONTENT_TYPE] => multipart/form-data; boundary=----WebKitFormBoundarymYH9tWHDcnvrsgFN 
		[HTTP_CONTENT_TYPE] => multipart/form-data; boundary=----WebKitFormBoundarymYH9tWHDcnvrsgFN 
		[HTTP_USER_AGENT] => Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36 
		[HTTP_ACCEPT] => text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 
		[HTTP_SEC_FETCH_SITE] => same-origin 
		[HTTP_SEC_FETCH_MODE] => navigate 
		[HTTP_SEC_FETCH_USER] => ?1 
		[HTTP_SEC_FETCH_DEST] => document 
		[HTTP_REFERER] => http://localhost:3000/Condominiunm-LTW/prova_upload.php 
		[HTTP_ACCEPT_ENCODING] => gzip, deflate, br, zstd 
		[HTTP_ACCEPT_LANGUAGE] => it-IT,it;q=0.9,en-US;q=0.8,en;q=0.7 
		[HTTP_COOKIE] => PHPSESSID=b9hm83l2c20crtfi4pbbc6a99i 
		[REQUEST_TIME_FLOAT] => 1715433194.0887 
		[REQUEST_TIME] => 1715433194 )


Array ( [upload-img] => Array ( [name] => FB_IMG_1533802567848.jpg 
								[full_path] => FB_IMG_1533802567848.jpg 
								[type] => image/jpeg 
								[tmp_name] => C:\Users\trast\AppData\Local\Temp\phpDE37.tmp 
								[error] => 0 
								[size] => 30545 ) )

UPLOAD_ERR_OK
Value: 0; There is no error, the file uploaded with success.

UPLOAD_ERR_INI_SIZE
Value: 1; The uploaded file exceeds the upload_max_filesize directive in php.ini.

UPLOAD_ERR_FORM_SIZE
Value: 2; The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form.

UPLOAD_ERR_PARTIAL
Value: 3; The uploaded file was only partially uploaded.

UPLOAD_ERR_NO_FILE
Value: 4; No file was uploaded.

UPLOAD_ERR_NO_TMP_DIR
Value: 6; Missing a temporary folder.

UPLOAD_ERR_CANT_WRITE
Value: 7; Failed to write file to disk.

UPLOAD_ERR_EXTENSION



riaggiustare grafica utente 
upload documenti previa iscrizione aptblock

area utente:
	popolare pagine, profilo, impostazioni()

admin funcs
 	creazione di Condominio (in attivita') <-
	Risposta ticket (1) 
	definizione common spaces (2) 
	gestione dei pagamenti --- mock
	definizione tags (3)

TODO: COMPLETA AREA UTENTE

----------------- SQL -----------------
GRANT USAGE ON SCHEMA public TO <anyusr>;
DELETE FROM ut_registered WHERE ut_id BETWEEN 35 AND 43


-- 1. rename the enum type you want to change
alter type ut_request_stat rename to _ut_request_stat;
-- 2. create new type
create type ut_request_stat as enum ('pending', 'accepted', 'refused', 'aborted', 'abandoned');
-- 3. rename column(s) which uses our enum type
alter table req_ut_access rename column status to _status;
-- 4. add new column of new type
alter table req_ut_access add status ut_request_stat not null default 'pending';
-- 5. copy values to the new column
update req_ut_access set status = _status::text::ut_request_stat;
-- 6. remove old column and type
alter table req_ut_access drop column _status;
drop type _ut_request_stat;
todo: verifica che le immagini di 03-prenota.php siano visualizzate correttamente
---------------- SQL END ----------------
tommaso@site.it - service

TODO: Use pg_query_params to execute parameterized queries, preventing SQL injection like this:
	 $q = "INSERT INTO ut_registered(nome, cognome, d_nascita, telefono, address, citta_residenza, ut_email, passwd) 
          VALUES ($1, $2, $3, $4, $5, $6, $7, $8)";
    $result = pg_query_params($connection, $q, array($nome, $cognome, $dnascita, $telefono, $address, $citta, $email, $password));

INSERT INTO ut_registered(nome, cognome, d_nascita, telefono, address, citta_residenza, ut_email, passwd) 
                VALUES ('nome7', 'cognome7', '1999-03-01', '2939420940', 'VIa bruh, 69', 'Catanzaro', 'nome7@site.it', '123');


// todo: scopri perche' lo storico condomini non si vede